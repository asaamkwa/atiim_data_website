<%- include('../partials/adminheader') %>

<div class="container-fluid">
  <div class="row min-vh-100">

    <!-- Sidebar -->
   
    <!-- Sidebar for desktop -->
    <nav class="col-md-3 col-lg-2 d-none d-md-block bg-light sidebar border-end">
      <div class="pt-4 px-3 text-center">

        <!-- Brand -->
        <i class="bi bi-speedometer2 fs-1 text-primary"></i>
        <h6 class="fw-bold mt-2">Admin Dashboard</h6>

        <!-- Menu -->
        <ul class="nav nav-pills flex-column gap-1 mt-4">
          <li class="nav-item">
            <a href="/admin/dashboard" class="nav-link active">
              <i class="bi bi-house me-2"></i> Dashboard
            </a>
          </li>
          <li class="nav-item">
            <a href="#" class="nav-link text-dark">
              <i class="bi bi-person me-2"></i> Profile
            </a>
          </li>
          <li class="nav-item">
            <a href="/admin/bundles" class="nav-link text-dark">
              <i class="bi bi-wifi me-2"></i>Bundles
            </a>
          </li>
          <li class="nav-item mt-3">
            <a href="/admin/logout" class="nav-link text-danger">
              <i class="bi bi-box-arrow-right me-2"></i> Logout
            </a>
          </li>
        </ul>

      </div>
    </nav>

    <!-- Offcanvas Sidebar for mobile -->
    <div class="d-md-none">
      <button class="btn btn-primary m-3" type="button" data-bs-toggle="offcanvas" data-bs-target="#mobileSidebar">
        <i class="bi bi-list"></i> Menu
      </button>

      <div class="offcanvas offcanvas-start" tabindex="-1" id="mobileSidebar">
        <div class="offcanvas-header">
          <h5 class="offcanvas-title">Admin Dashboard</h5>
          <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas"></button>
        </div>
        <div class="offcanvas-body">
          <ul class="nav nav-pills flex-column gap-2">
            <li class="nav-item"><a href="/admin/dashboard" class="nav-link active">Dashboard</a></li>
            <li class="nav-item"><a href="#" class="nav-link">Profile</a></li>
            <li class="nav-item"><a href="/admin/bundles" class="nav-link">Bundles</a></li>
            <li class="nav-item"><a href="/admin/logout" class="nav-link text-danger">Logout</a></li>
          </ul>
        </div>
      </div>
    </div>

    <!-- Main Content -->
    <main class="col-md-9 col-lg-10 px-4 py-4">

  <a href="/admin/add/data" class="btn btn-primary">
    Add New Data Bundle
  </a>

   <form method="GET" action="/admin/bundles" class="mb-3 d-flex gap-2 align-items-center">
  <label for="network" class="mb-0">Filter by Network:</label>
  <select name="network" id="network" class="form-select w-auto">
    <option value="">All</option>
    <option value="MTN" <%= networkFilter === 'MTN' ? 'selected' : '' %>>MTN</option>
    <option value="AIRTELTIGO" <%= networkFilter === 'AIRTELTIGO' ? 'selected' : '' %>>AirtelTigo</option>
    <option value="TELECEL" <%= networkFilter === 'TELECEL' ? 'selected' : '' %>>Telecel</option>
  </select>
  <button class="btn btn-secondary">Filter</button>
</form>
 

    <% if (success && success.length) { %>
      <div class="alert alert-success"><%= success[0] %></div>
    <% } %>

    <table class="table table-bordered table-hover">
      <thead class="table-light">
        <tr>
          <th>Network</th>
          <th>Bundle</th>
          <th>Price (GHS)</th>
          <th>Status</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <% bundles.forEach(b => { %>
          <tr>
            <td><%= b.network %></td>
            <td><%= b.name %></td>
            <td><%= b.price %></td>
            <td>
              <span class="badge <%= b.isActive ? 'bg-success' : 'bg-secondary' %>">
                <%= b.isActive ? 'Active' : 'Inactive' %>
              </span>
            </td>
            <td class="d-flex gap-1">
              <a href="/admin/bundles/edit/<%= b._id %>" class="btn btn-sm btn-warning">Edit</a>

              <form action="/admin/bundles/toggle/<%= b._id %>" method="POST">
                <button class="btn btn-sm btn-info">
                  <%= b.isActive ? 'Deactivate' : 'Activate' %>
                </button>
              </form>

              <form action="/admin/bundles/delete/<%= b._id %>" method="POST"
                onsubmit="return confirm('Delete this bundle?')">
                <button class="btn btn-sm btn-danger">Delete</button>
              </form>
            </td>
          </tr>
        <% }) %>
      </tbody>
    </table>


    </main>
  </div>
</div>

<%- include('../partials/footer') %>
